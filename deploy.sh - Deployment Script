#!/bin/bash

# Hip Hop Legends Beat Maker - Quick Deploy Script
# This script automates the Railway deployment process

set -e  # Exit on error

echo "ğŸµ Hip Hop Legends Beat Maker - Railway Deployment"
echo "=================================================="
echo ""

# Colors for output
GREEN='\033[0;32m'
BLUE='\033[0;34m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Check if Railway CLI is installed
if ! command -v railway &> /dev/null; then
    echo -e "${RED}âŒ Railway CLI not found${NC}"
    echo -e "${YELLOW}ğŸ“¦ Installing Railway CLI...${NC}"
    npm install -g @railway/cli
fi

# Check if we're in a git repository
if [ ! -d .git ]; then
    echo -e "${BLUE}ğŸ“ Initializing Git repository...${NC}"
    git init
    git add .
    git commit -m "Initial commit: Hip Hop Legends Beat Maker"
    echo -e "${GREEN}âœ… Git repository initialized${NC}"
else
    echo -e "${GREEN}âœ… Git repository detected${NC}"
fi

# Check if node_modules exists
if [ ! -d node_modules ]; then
    echo -e "${BLUE}ğŸ“¦ Installing dependencies...${NC}"
    npm install
    echo -e "${GREEN}âœ… Dependencies installed${NC}"
else
    echo -e "${GREEN}âœ… Dependencies already installed${NC}"
fi

# Login to Railway
echo -e "${BLUE}ğŸ” Logging into Railway...${NC}"
railway login

# Initialize Railway project
echo -e "${BLUE}ğŸš€ Initializing Railway project...${NC}"
railway init

# Deploy to Railway
echo -e "${BLUE}â˜ï¸  Deploying to Railway...${NC}"
railway up

# Generate domain
echo -e "${BLUE}ğŸŒ Generating domain...${NC}"
railway domain

echo ""
echo -e "${GREEN}=================================================="
echo "âœ… Deployment Complete!"
echo "==================================================${NC}"
echo ""
echo -e "${YELLOW}ğŸ“‹ Next Steps:${NC}"
echo "1. Check your Railway dashboard for the deployment URL"
echo "2. Test your beat maker application"
echo "3. Upload some samples and create beats!"
echo ""
echo -e "${BLUE}ğŸ”— Useful Commands:${NC}"
echo "  railway logs     - View application logs"
echo "  railway open     - Open project in Railway dashboard"
echo "  railway status   - Check deployment status"
echo ""
echo -e "${GREEN}ğŸ¤ Happy beat making! ğŸ”¥${NC}"
